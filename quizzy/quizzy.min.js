/*! quizzy - v0.0.5 - 2013-07-21
* Copyright (c) 2013 ; Licensed  */
var quizzy=function(){function a(a,b,c){if(b.addEventListener)b.addEventListener(a,c,!1);else{if(!b.attachEvent)throw new Error("The supplied object does not support either event methods.");b.attachEvent("on"+a,c)}}function b(a){var b={};for(var d in g)b[d]=g[d];for(var d in a)b[d]=a[d];c.config=b}var c={},d={};d.STRING_RADIO="radio",d.NUMBER_DEFAULT_SCORE_PER_QUESTION=1;var e,f,g={allowBackTrack:!1,showHistory:!1,backDistance:0,shuffle:!1,questions:null,startPoint:null,nextBtnText:"Next Question",prevBtnText:"Previous Question",restartBtnText:"Restart Quiz"};return c.currentQuestion,c.questions,c.config,c.quizElements,QuizzyQuestion=function(a){this.question=a.question,this.answer=a.answer,this.choices=a.choices;for(var b=0;b<this.choices.length;b++)this.choices[b]=this.choices[b]+"";this.score=a.score||d.NUMBER_DEFAULT_SCORE_PER_QUESTION,this.type=a.type||d.STRING_RADIO,this.userChoice=null},c.init=function(a){a?b(a):c.config=g,c.setUpQuestions(c.config.questions),f=0,c.questionCount=e.size(),c.createQuizInterface(),c.start()},c.setUpQuestions=function(a){var b;b=a?a.slice():QuizzyQuestions.slice(),c.questions=[];for(var d=0;d<b.length;d++)c.questions.push(new QuizzyQuestion(b[d]));b=null,e=c.questions.slice(),quizzyUtils.shuffleArray(e),e=new QuizzyList(e)},c.start=function(){c.currentQuestion=e.getFirst(),c.updateQuizInterface()},c.updateQuizInterface=function(){var a,b;c.quizElements.quizHeader.innerHTML=c.currentQuestion.value.question;for(var d,e=document.createDocumentFragment(),f=c.quizElements.inputWrap.firstChild;f;)d=null,("LABEL"==f.tagName||"INPUT"==f.tagName)&&(d=f),f=f.nextSibling,d&&d.parentNode.removeChild(d);for(a=c.createInput("radio",c.currentQuestion.value.choices),b=0;b<a.length;b++)e.appendChild(c.wrapInLabel(a[b]));c.quizElements.inputWrap.appendChild(e),e=a=null},c.createQuizInterface=function(){c.quizElements={fragment:document.createDocumentFragment(),quizHeader:document.createElement("h2"),inputWrap:document.createElement("div"),buttons:{},container:null},c.quizElements.quizHeader.id="quizzy-title",c.quizElements.inputWrap.id="quizzy-input-wrap",c.quizElements.buttons.next=c.createButton(c.config.nextBtnText,"quizzy-next"),c.quizElements.buttons.restart=c.createButton(c.config.restartBtnText,"quizzy-restart"),a("click",c.quizElements.buttons.next,c.nextQuestion),c.quizElements.fragment.appendChild(c.quizElements.quizHeader),c.quizElements.fragment.appendChild(c.quizElements.inputWrap),c.config.allowBackTrack&&(c.quizElements.buttons.prev=c.createButton(c.config.prevBtnText,"quizzy-prev"),a("click",c.quizElements.buttons.prev,c.prevQuestion),c.quizElements.fragment.appendChild(c.quizElements.buttons.prev),quizzyUtils.hideElement(c.quizElements.buttons.prev)),c.quizElements.fragment.appendChild(c.quizElements.buttons.next),c.config.startPoint&&document.getElementById(c.config.startPoint)?(c.quizElements.container=document.createElement("div"),c.quizElements.id="quizzy",c.quizElements.container.appendChild(c.quizElements.fragment),document.getElementById(c.config.startPoint).appendChild(c.quizElements.container)):(c.quizElements.container=document.getElementById("quizzy"),c.quizElements.container.appendChild(c.quizElements.fragment))},c.createButton=function(a,b,c){var d=document.createElement("button");if(d.id=b||"",d.innerHTML=a||"",c instanceof Array){for(var e=" ",f=0;f<c.length;f++)e+=c[f]+" ";c=e}return d.className=c||"",d},c.getNextQuestion=function(){return c.currentQuestion.next||!1},c.getPrevQuestion=function(){return c.currentQuestion.prev||!1},c.jumpToQuestion=function(){},c.prevQuestion=function(){if(c.config.allowBackTrack){var a=c.getPrevQuestion();a!==!1&&(c.currentQuestion=a,console.log(c.currentQuestion.prev),c.updateQuizInterface(),c.currentQuestion.prev||quizzyUtils.hideElement(c.quizElements.buttons.prev))}},c.nextQuestion=function(){var a=c.getUserSelection();if(null===a)return c.showError("Please select an answer"),void 0;c.currentQuestion.value.userChoice=a;var b=c.getNextQuestion();b===!1?c.end():(c.config.allowBackTrack&&quizzyUtils.showElement(c.quizElements.buttons.prev),c.currentQuestion=b,c.updateQuizInterface(),b=null)},c.getUserSelection=function(){for(var a=c.quizElements.inputWrap.getElementsByTagName("input"),b=null,d=0;d<a.length;d++)a[d].checked&&(b=a[d].value);return b},c.showError=function(a){alert(a)},c.checkAnswer=function(){for(var a,b=c.currentQuestion.value.answer,d=c.quizElements.inputWrap.getElementsByTagName("input"),e=0;e<d.length;e++)d[e].checked&&(a=d[e].value);a?(a==c.currentQuestion.value.choices[b]&&(f+=c.currentQuestion.value.score),c.nextQuestion()):alert("You didn't input anything!")},c.checkAllAnswers=function(){for(var a=e.getFirst(),b=0,c=!1;a;){for(b=0;b<a.value.choices.length;b++)c=!1,c||a.value.userChoice!=a.value.choices[b]||(c=!0,f+=a.value.score);a=a.next}},c.calculateScore=function(){return f},c.getRawScore=function(){return f},c.end=function(){c.checkAllAnswers(),c.quizElements.quizHeader.parentNode.removeChild(c.quizElements.quizHeader);for(var a=c.quizElements.inputWrap.firstChild;a;)removeNode=a,a=a.nextSibling,removeNode&&removeNode.parentNode.removeChild(removeNode);var b=document.createElement("h2");b.innerHTML="Your final score is: "+c.calculateScore(),c.quizElements.container.insertBefore(b,c.quizElements.container.firstChild)},c.wrapInLabel=function(a,b){var c=document.createElement("label");return c.appendChild(a),c.innerHTML+=b||a.value,c},c.createInput=function(a,b){a=a||"radio",a=a.toLowerCase();var d=[];if(isNaN(b))if(b)for(var e=0;e<b.length;e++)"radio"==a&&d.push(c.createRadioButton("quizzy-radio",b[e]));else d.push(c.createRadioButton("quizzy-radio"));else for(var e=0;b>e;e++)"radio"==a&&d.push(c.createRadioButton("quizzy-radio"));return d},c.createRadioButton=function(a,b,c,d){var e=document.createElement("input");if(e.type="radio",e.name=a||"",e.value=b||"",e.id=c||"",d instanceof Array){for(var f=" ",g=0;g<d.length;g++)f+=d[g]+" ";d=f}return e.className=f,e},c}(),quizzyUtils={};quizzyUtils.getRandomInteger=function(a,b){return a+Math.floor(Math.random()*(b-a+1))},quizzyUtils.shuffleArray=function(a){for(var b,c,d=a.length-1;d>=0;d--)c=this.getRandomInteger(0,d),b=a[d],a[d]=a[c],a[c]=b},quizzyUtils.hideElement=function(a){"none"!==a.style.display&&(a.style.display="none",a.style.visibility="hidden")},quizzyUtils.showElement=function(a){"none"===a.style.display&&(a.style.display="",a.style.visibility="")};var QuizzyList=function(a){var b,c,d={},e=0;d.push=function(a){var d=new f(a);return 0===e?b=c=d:(c.next=d,d.prev=c,c=d),e++,d},d.pop=function(){var a=c;return c=c.prev,e--,a},d.shift=function(){var a=b;return b=b.next,e--,a},d.remove=function(a){var c,d=b;if(0===a)return e--,this.shift();if(a===e)return this.pop();for(;a--;)d=d.next;return c=d,d.prev.next=d.next,d.next.prev=d.prev,c},d.get=function(a){var d;if(0===a)return b;if(a===size-1)return c;for(d=first;a--;)d=d.next;return d},d.size=function(){return e},d.getFirst=function(){return b},d.getLast=function(){return c},d.arrayToList=function(a){for(var b=0;b<a.length;b++)d.push(a[b])};var f=function(a){this.value=a};return a&&d.arrayToList(a),d},_hours=36e5,_minutes=6e4,_seconds=1e3;QuizzyTimer=function(a,b,c){this.handler=b||null,this.tick=a||20,this.elapsed=0,this.last=0,this.clock=0,this.minutes=0,this.seconds=0,this.milliseconds=0,console.log(this.tick),c&&this.start()},QuizzyTimer.prototype.start=function(){console.log(this.tick),this.last=Date.now();var a=this;this.intervalId=setInterval(function(){a.update()},this.tick)},QuizzyTimer.prototype.stop=function(){clearInterval(this.intervalId)},QuizzyTimer.prototype.update=function(){this.elapsed=Date.now()-this.last,this.clock+=this.elapsed,this.milliseconds+=elapsed,this.seconds+=Math.floor(this.milliseconds/_seconds),this.minutes+=Math.floor(this.seconds/60),this.hours=Math.floor(this.clock/_hours),this.seconds>60&&(this.seconds=0),this.minutes>60&&(this.this.last=Date.now())},QuizzyTimer.prototype.getTime=function(){return{hours:this.hours,minutes:this.minutes,seconds:this.seconds,milliseconds:this.clock}},QuizzyTimer.prototype.printTime=function(){var a,b,c,d=this.getTime();a=d.hours,b=d.minutes<10?"0"+d.minutes:d.minutes,c=d.seconds<10?"0"+d.seconds:d.seconds,console.log(a+":"+b+":"+c)};